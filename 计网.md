

## TCP

### TCP粘包和拆包

> 拆包 —— 一个完整的业务被TCP拆分多个包进行发送
>
> 粘包 —— 多个小包被封装成一个大的数据包进行发送

原因：

1. 应用程序写入数据字节大小大于套接字发送缓冲区的大小
2. 进行MSS大小的TCP分段 （MSS = TCP报文段长度 - TCP首部长度）
3. 数据帧大于MTU进行IP分片 （MTU数据链路层对数据帧长度的限制）

---

## HTTP

### HTTP请求过程

域名解析 --> TCP3次握手 --> 建立TCP连接后发起http请求 --> 服务器相应http请求, 浏览器得到html代码 --> 浏览器解析http代码, 请求html中资源(js, css, 图片等) --> 浏览器对页面渲染

### HTTP长连接和短连接

HTTP/1.0默认使用短连接，客户端和服务器每次进行一次HTTP操作都要进行建立连接和中断连接

HTTP/1.1默认使用长连接，用以保持连接特性

### HTTPS和HTTP的区别

1. HTTP协议传输的数据都是明文，因此HTTP协议传输隐私信息是非常不安全的，HTTPS协议是由SSL+HTTP协议构建的可进行**加密传输**、**身份认证**的网络协议，比HTTP协议更安全
2. HTTPS协议需要到ca申请证书
3. HTTP和HTTPS使用的是完全不同的连接方式，前者用的是**80端口**，后者是**443端口**

### HTTP请求方法

客户端发送的 **请求报文** 的第一行为请求行，包含方法字段

HTTP/1.0定义三种 —— GET，POST，HEAD

HTTP/1.1新增六种 —— OPTIONS、PUT、PATCH、DELETE、TRACE、CONNECT

| 序号 | 方法    | 描述                                                         |
| ---- | ------- | ------------------------------------------------------------ |
| 1    | GET     | 请求指定页面信息，并返回实体主体                             |
| 2    | HEAD    | 类似GET请求，返回响应中没有具体内容，只有头                  |
| 3    | POST    | 向指定资源提交数据进行处理请求（如表单、文件）。数据被包含在请求体中，POST请求会导致新的资源的建立或已有资源的修改 |
| 4    | PUT     | 从客户端向服务器传送的数据取代指定的文档内容                 |
| 5    | PATCH   | PUT的补充，用来对已知资源进行局部更新                        |
| 5    | DELETE  | 请求服务器删除指定页面                                       |
| 6    | CONNECT | HTTP/1.1预留给能将连接改为管道方式的代理服务器               |
| 7    | OPTION  | 允许客户端查看服务器性能                                     |
| 8    | TRACE   | 回显服务器收到的请求，用于测试                               |

### GET 和 POST 的区别

1. GET是获取数据，POST是修改数据

2. GET把请求的数据放在url上，以？分割URL和传输数据，参数之间以&相连，所以GET不安全，POST把数据放在http的包体内（request body）

3. GET提交的数据最大时2k（实际限制取决与浏览器），POST理论上没有限制

4. GET产生一个TCP数据包，浏览器会把http head和data一并发送出去，服务器响应200（返回数据）， POST产生两个TCP数据包，浏览器先发送header，服务器响应100 contine， 浏览器再发送data服务器响应200 ok（返回数据）

5. 本质区别：GET是幂等的，POST不是幂等的

   > 幂等性：幂等性是指一次和多次请求某一个资源应该具有同样的副作用，简单来说对同一个URL的多个请求应该返回同样的结果

   因为他们有这样的区别，所以**不应该且不能用GET请求做数据的增删查改这些有副作用的操作**，因为GET是幂等的，**在网络不好的隧道中会尝试重试**，如果用GET请求做增数据，会有**重复操作**的风险，而这种重复操作可能会导致副作用（浏览器和操作系统不知道你会用GET做增操作） 

### 一个TCP连接可以对应几个HTTP请求

长连接可以对应多个HTTP请求

### 一个TCP连接中HTTP请求发送可以一起发送么？（比如一起发三个请求， 再三个响应一起接收）

HTTP/1.1存在一个问题，单个TCP连接再同一时刻智能处理一个请求，两个请求的生命周期不能重叠

HTTP/2中多个HTTP请求可以在一个TCP中并行进行

---

## DNS域名解析

> mail.cctv.com             mai 三级域名    cctv 二级域名     com 顶级域名

DNS(Domain name system), 域名和IP地址相互映射的一个分布式数据库

将主机名转换为ip地址, 属于应用层协议, 使用UDP传输

主机向本地域名服务器查询一般采用递归查询, 本地域名服务器向根域名服务器查询采用迭代查询

### DNS工作原理

1) 用户输入域名, 浏览器首先检查浏览器缓存中是否含有此域名映射的IP地址
2) 若无命中, 则检查系统缓存
3) 若无命中, 则通过发送DNS报文请求本地域名服务器解析（LDNS）
4) 如LDNS无命中，则向根域名服务器请求解析，根域名服务器返回给LDNS的一个通用顶级域服务器（gTLD）的ip地址
5) LDNS向上一步返回的gTLD发送请求，gTLD返回给LDNS一个授权域名服务器的ip地址
6) LDNS向上一步返回的授权域名服务器发送请求，授权域名服务器将结果返回给LDNS
7) LDNS缓存这个域名和对应的ip，把解析的结果返回给客户机，客户机根据TLL值缓存到本地系统缓存中，域名解析结束

### DNS负载均衡是什么策略

DNS服务器中为同一个主机名配置多个IP地址，在应答DNS查询时，DNS服务器对每个查询将以DNS文件中主机记录的IP地址按顺序返回不同的解析结果，将客户端的访问引导到不同的机器上去，使得不同的客户端访问不同的服务器，从而达到负载均衡的目的，例如根据每台机器的负载量，该机器里用户的地理位置等等。

---

## 为什么服务器会有缓存， 如何实现

原因：

1. 缓解服务器压力
2. 降低客户端获取资源的延迟；缓存通常位于内存中，读取缓存的速度更快，并且缓存服务器再地理位置上可能比源服务器更近，比如浏览器缓存

实现方式：

1. 让代理服务器进行缓存
2. 让客户端浏览器进行缓存

## 什么是SSL/TSL

SSL代表安全套接字层。它是一种用于加密和验证的应用程序和web服务器之间发送的数据协议。身份认证，HTTPS的加密机制是一种**共享密钥加密和公开密钥加密并用的混合加密机制**

SSL/TSL协议的作用：认证用户和服务，加密数据，维护数据的完整性的应用层协议加密和解密需要两个不同的密钥，故称为非对称加密；加密和解密使用同一个密钥的对称加密——加解密效率较高。HTTPS是基于非对称加密的，公钥是公开的